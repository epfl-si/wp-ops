# Set up one DeploymentConfig/nginx-* object and one Service/nginx-* object, described by the
# {{ dc }} variable.

- tags: always
  include_vars: "../vars/secrets-{{ inventory_namespace }}.yml"

- name: "Secret SMTP password ({{ smtp.username }})"
  openshift:
    state: latest
    apiVersion: v1
    kind: Secret
    type: Opaque
    metadata:
      name: "smtp-password"
      namespace: "{{ inventory_namespace }}"
    data:
       SERVICE_WWP_NOREPLY_PASSWORD: "{{ smtp.password | eyaml(eyaml_keys) | b64encode }}"
  tags: httpd.secrets
