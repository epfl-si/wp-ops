- include_vars: s3-secrets-vars.yml
  tags: always

- name: ConfigMap/s3-configmap-for-os4
  kubernetes.core.k8s:
    state: present
    definition:
      apiVersion: v1
      kind: ConfigMap
      metadata:
        name: s3-configmap-for-os4
        namespace: "{{ inventory_namespace }}"
      data:
        s3_bucket_name: "{{ s3_buckets['os4'][inventory_deployment_stage]['bucket_name'] }}"
        path: "{{ s3_buckets['os4'][inventory_deployment_stage]['path'] }}"

- name: ConfigMap/s3-configmap-for-os3
  kubernetes.core.k8s:
    state: present
    definition:
      apiVersion: v1
      kind: ConfigMap
      metadata:
        name: s3-configmap-for-os3
        namespace: "{{ inventory_namespace }}"
      data:
        s3_bucket_name: "{{ s3_buckets['os3']['production']['bucket_name'] }}"
        path: "{{ s3_buckets['os3']['production']['path'] }}"
