- name: wp-base/RBAC
  include_tasks:
    file: rbac.yml
    apply:
      tags:
        - wp.base.build
        - wp.base.rbac
  tags:
    - wp.base.build
    - wp.base.rbac

- name: wp-base/Secrets
  include_tasks:
    file: secrets.yml
    apply:
      tags:
        - wp.base.build
        - wp.base.secrets
  tags:
    - wp.base.build
    - wp.base.secrets

- name: Mirror images used to build `FROM`
  include_tasks:
    file: mirrors.yml
    apply:
      tags:
        - wp.base.mirrors
  tags:
    - wp.base.mirrors

- name: Toolbox image
  include_tasks:
    file: toolbox.yml
    apply:
      tags:
        - wp.toolbox
        - wp.build.toolbox
  tags:
    - wp.toolbox
    - wp.build.toolbox
    - wp.toolbox.rebuild
    - wp.build.toolbox.rebuild

- name: wp-base/Tekton
  include_tasks:
    file: tekton.yml
    apply:
      tags:
        - wp.base.build
        - wp.base.tekton
  tags:
    - wp.base.build
    - wp.base.tekton
    - wp.base.tekton.toolbox.rebuild

- name: Kong reverse proxy for blue/green(/red/yellow/orange) testing
  include_tasks:
    file: continuous-integration.yml
    apply:
      tags:
        - wp.ci
        - wp.ci.kong
        - wp.continuous-integration
        - wp.continuous-integration.kong
  tags:
        - wp.ci
        - wp.ci.kong
        - wp.continuous-integration
        - wp.continuous-integration.kong
        - wp.continuous-integration.kong.rebuild
        - wp.continuous-integration.kong.restart
        - wp.continuous-integration.rebuild
        - wp.continuous-integration.restart
