---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: wpn-nginx
  namespace: wordpress-test
stringData:
  get_db_credentials.php: |
    <?php

    namespace __entrypoint;
    function get_db_credentials ($wordpress) {
        // TODO: look these up from a JSON Secret, maintained by the WordPress operator, tabulating all sites

        switch ($wordpress['site_uri']) {
            case '/site-A/':
                return array('db_host' => 'mariadb-min',
                             'db_name' => 'wp-db-site-a',
                             'db_user' => 'wp-db-user-a',
                             'db_password' => 'secret');
            case '/site-B/':
                return array('db_host' => 'mariadb-min',
                             'db_name' => 'wp-db-site-b',
                             'db_user' => 'wp-db-user-b',
                             'db_password' => 'secret');
            case '/site-A/site-C/':
                return array('db_host' => 'mariadb-min',
                             'db_name' => 'wp-db-site-c',
                             'db_user' => 'wp-db-user-c',
                             'db_password' => 'secret');
            case '/site-R/':
                return array('db_host' => 'mariadb-min',
                             'db_name' => 'wp-db-site-r',
                             'db_user' => 'wp-db-user-r',
                             'db_password' => 'secret');
            case '/':
                return array('db_host' => 'mariadb-min',
                             'db_name' => 'wordpress-test',
                             'db_user' => 'wordpress',
                             'db_password' => 'secret');
        }
    }
