---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: wpn-nginx
  namespace: wordpress-test
stringData:
  get_db_credentials.php: |
    <?php
    namespace __entrypoint;
    function get_db_credentials ($wordpress) {
        $databases_config = [
            '/site-A/' => [
                'db_host' => 'mariadb-min',
                'db_name' => 'wp-db-site-a',
                'db_user' => 'wp-db-user-site-a',
                'db_password' => 'secret'
            ],
            '/site-B/' => [
                'db_host' => 'mariadb-min',
                'db_name' => 'wp-db-site-b',
                'db_user' => 'wp-db-user-site-b',
                'db_password' => 'secret'
            ],
            '/site-A/site-C/' => [
                'db_host' => 'mariadb-min',
                'db_name' => 'wp-db-site-c',
                'db_user' => 'wp-db-user-site-c',
                'db_password' => 'secret'
            ],
            '/site-E/' => [
                'db_host' => 'mariadb-min',
                'db_name' => 'wp-db-site-r',
                'db_user' => 'wp-db-user-site-e',
                'db_password' => 'secret'
            ],
            '/site-R/' => [
                'db_host' => 'mariadb-min',
                'db_name' => 'wp-db-site-r',
                'db_user' => 'wp-db-user-site-r',
                'db_password' => 'secret'
            ],
            '/' => [
                'db_host' => 'mariadb-min',
                'db_name' => 'wordpress-test',
                'db_user' => 'wordpress',
                'db_password' => 'secret'
            ],
        ];
        error_log(print_r($wordpress, true));
        return $databases_config[$wordpress['site_uri']];
    }
