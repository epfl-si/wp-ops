apiVersion: k8s.mariadb.com/v1alpha1
kind: Backup
metadata:
  namespace: wordpress-test
  name: scheduled-backup-site-a-test-s3
spec:
  mariaDbRef:
    name: mariadb-min
  databases:
    - wp-db-site-a
#  schedule:
#    cron: "*/1 * * * *"
#    suspend: false
#  storage:
#    persistentVolumeClaim:
#      resources:
#        requests:
#          storage: 100Mi
#      accessModes:
#        - ReadWriteOnce
  storage:
    s3:
      bucket: svc0041-5da0d377aa221ddc24a6110fee695f69
      prefix: backup/k8s
      endpoint: s3.epfl.ch
      accessKeyIdSecretKeyRef:
        name: s3-backup-credentials
        key: keyId
      secretAccessKeySecretKeyRef:
        name: s3-backup-credentials
        key: accessSecret
      tls:
        enabled: true

---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: s3-backup-credentials
  namespace: wordpress-test
stringData:
  keyId: REPLACE_THIS_WITH_KEY_ID
  accessSecret: REPLACE_THIS_WITH_ACCESS_SECRET
